tags:
  - name: cart
    description: Work with carts

# TODO: Add 401 Unauthorized response to all endpoints and 403 Forbidden to all endpoints
paths:
  /api/carts/:
    get:
      summary: Get all cart
      tags:
        - Carts
      responses:
        '200':
          description: OK
          content:
            aplication/json:
              schema:
                type: array
                items: 
                  $ref: "#components/schemas/Cart"
        '5XX':
          description: Unexpected error, something went wrong in the server

    post:
      summary: Create a new cart
      tags:
        - Carts
      requestBody: 
        content:
          application/json:
            schema:
              $ref: "#components/schemas/Cart"
        required: true
      responses:
        '200':
          description: OK (cart created)
          content:
            aplication/json:
              schema:
                type: array
                items: 
                  $ref: "#components/schemas/Cart"
        '5XX':
          description: Unexpected error, something went wrong in the server

  /api/carts/{cid}/product/{pid}:
    post:
      summary: Add a product to a cart
      tags:
       - Carts
      security:
        - cookieAuth: []
      parameters:
      - name: cid
      - name: pid
        in: path
        description: takes the identification of the cart and the product through the parameters 
        required: true
        type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Cart'
      responses:
        '200':
          description: OK (cart updated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cart'
        '400':
          description: Bad Request (missing or invalid cart id or product id)
        '401':
          $ref: '#/components/responses/401Unauthorized'
        '403':
          $ref: '#/components/responses/403Forbidden'
        '409':
          description: Conflict with some data in the request
        '5XX':
          description: Unexpected error, something went wrong in the server

  /api/carts/{cid}/:
    get:
      summary: Get a cart 
      tags:
        - Carts
      parameters: 
        - name: cid
          in: path
          required: true
          description: id of the cart you want to consult
          schema: 
            $type: String
      responses:
        '200':
          description: OK (cart found)
          content:
            aplication/json:
              schema:
                type: array
                items: 
                  $ref: "#components/schemas/Cart"
        '404':
          description: Not found (cart not found)
        '5XX':
          description: Unexpected error, something went wrong in the server

components:
  schemas: 
    Cart:
      type: object
      properties:
        -id:
          type: ObjectId,
          description: ID autogenerated by Mongoose
        products: 
          type: array
          description: The products in the cart
          items:
            type: object
            properties:
              _id:
                type: string
                format: ObjectId
                description: The product ID
              quantity:
                type: number
                description: The quantity of the product
      example:
        _id: 65a55d954d82f6d66ec11c7e,
        products: [
                {
                    product: 658ba61f92e02f1cb036f330,
                    quantity: 9,
                    _id: 65dd230048ba5300cc7008b0
                }
            ]
          
       